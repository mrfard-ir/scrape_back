var W=Object.defineProperty;var q=(s,e,t)=>e in s?W(s,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):s[e]=t;var v=(s,e,t)=>q(s,typeof e!="symbol"?e+"":e,t);import{m as L,h as p,j as b,k as w,n as h,l as y,o as l,z as u,p as A,q as D,u as B,A as F,b as o,v as Y,r as U,s as G,t as x,w as P,x as j,y as T,B as N,C as H,E as J,F as M,G as $,H as V,I as K,J as z,K as Q}from"./index-ZHe-17bh.js";class Z{constructor(e,t,i,a,n,r){this.analyticsService=e,this.accessService=t,this.appService=i,this.notificationService=a,this.i18nService=n,this.globalStateService=r}async sendAnalyticEvent(e){return await Promise.resolve(),this.analyticsService.sendEvent(e),{success:!0,data:{success:!0}}}async showWebsitePage(e){return await this.accessService.proceedToWebsitePage(e),{success:!0,data:{success:!0}}}async setColorTheme(e){return await this.appService.setColorTheme(e),{success:!0,data:{success:!0}}}async getAppData(){return await Promise.resolve(),{success:!0,data:{version:this.appService.version,theme:this.appService.colorTheme,isOnline:this.globalStateService.hasInternetConnection}}}async getShowOnboarding(){return await Promise.resolve(),{success:!0,data:{show:this.appService.showOnboarding}}}async closeOnboarding(){return await this.appService.setShowOnboarding(!1),{success:!0,data:{success:!0}}}async setActiveLocale(e){return await this.i18nService.setLocale(e),{success:!0,data:{success:!0}}}async getActiveLocale(){return await Promise.resolve(),{success:!0,data:{locale:this.i18nService.activeLocale}}}async getLanguageList(){return await Promise.resolve(),{success:!0,data:{list:this.i18nService.languageList}}}async getNotificationPermition(){return await Promise.resolve(),{success:!0,data:{permition:this.notificationService.permition}}}async setNotificationPermition(e){return await this.notificationService.setNotificationPermition(e),{success:!0,data:{success:!0}}}async getSessionCount(){return await Promise.resolve(),{success:!0,data:{count:this.appService.sessionCount}}}async incrementSessionCount(){return await this.appService.incrementSessionCount(),{success:!0,data:{success:!0}}}async getPremiumBanner(){return await Promise.resolve(),{success:!0,data:{timestamp:this.appService.premiumBannerTimestamp}}}async incrementPremiumBanner(){return await this.appService.incrementPremiumBannerTimestamp(),{success:!0,data:{success:!0}}}async getDownloadLink(e){return{success:!0,data:{link:await this.appService.getDownloadLink(e)}}}async getBlockAds(){return await Promise.resolve(),{success:!0,data:{status:this.appService.isBlockAds}}}async setBlockAds(e){return await this.appService.setBlockAds(e.status),{success:!0,data:{success:!0}}}}class X{constructor(e,t){this.messageService=e,this.appController=t}init(){this.messageService.subscribe({"hold-active-ping":this.holdActivePing.bind(this),"send-analytic-event":this.sendAnalyticEvent.bind(this),"show-website-page":this.showWebsitePage.bind(this),"set-color-theme":this.setColorTheme.bind(this),"get-app-data":this.getAppData.bind(this),"get-show-onboarding":this.getShowOnboarding.bind(this),"close-onboarding":this.closeOnboarding.bind(this),"set-active-locale":this.setActiveLocale.bind(this),"get-active-locale":this.getActiveLocale.bind(this),"get-language-list":this.getLanguageList.bind(this),"set-notification-permition":this.setNotificationPermition.bind(this),"get-notification-permition":this.getNotificationPermition.bind(this),"get-session-count":this.getSessionCount.bind(this),"increment-session-count":this.incrementSessionCount.bind(this),"get-premium-banner":this.getPremiumBanner.bind(this),"increment-premium-banner":this.incrementPremiumBanner.bind(this),"get-download-link":this.getDownloadLink.bind(this),"get-block-ads":this.getBlockAds.bind(this),"set-block-ads":this.setBlockAds.bind(this)})}async holdActivePing(){return await Promise.resolve(this),{type:"hold-active-ping",success:!0,data:{success:!0}}}async sendAnalyticEvent(e){return{...await this.appController.sendAnalyticEvent(e),type:"send-analytic-event"}}async showWebsitePage(e){return{...await this.appController.showWebsitePage(e),type:"show-website-page"}}async setColorTheme(e){return{...await this.appController.setColorTheme(e),type:"set-color-theme"}}async getAppData(){return{...await this.appController.getAppData(),type:"get-app-data"}}async getShowOnboarding(){return{...await this.appController.getShowOnboarding(),type:"get-show-onboarding"}}async closeOnboarding(){return{...await this.appController.closeOnboarding(),type:"close-onboarding"}}async setActiveLocale(e){return{...await this.appController.setActiveLocale(e),type:"set-active-locale"}}async getActiveLocale(){return{...await this.appController.getActiveLocale(),type:"get-active-locale"}}async getLanguageList(){return{...await this.appController.getLanguageList(),type:"get-language-list"}}async setNotificationPermition(e){return{...await this.appController.setNotificationPermition(e),type:"set-notification-permition"}}async getNotificationPermition(){return{...await this.appController.getNotificationPermition(),type:"get-notification-permition"}}async getSessionCount(){return{...await this.appController.getSessionCount(),type:"get-session-count"}}async incrementSessionCount(){return{...await this.appController.incrementSessionCount(),type:"increment-session-count"}}async getPremiumBanner(){return{...await this.appController.getPremiumBanner(),type:"get-premium-banner"}}async incrementPremiumBanner(){return{...await this.appController.incrementPremiumBanner(),type:"increment-premium-banner"}}async getDownloadLink(e){return{...await this.appController.getDownloadLink(e),type:"get-download-link"}}async getBlockAds(){return{...await this.appController.getBlockAds(),type:"get-block-ads"}}async setBlockAds(e){return{...await this.appController.setBlockAds(e),type:"set-block-ads"}}}const ee=new Z(p,b,w,h,y,l),te=new X(L,ee),se=u.object({sessionId:u.string().describe(A.session)}).default({sessionId:""}),ie=new D(se),ae="https://www.google-analytics.com/mp/collect",ne="G-JY9WLXGNHW",oe="cECyLU2hSiaL1TVJULha8Q",m=B.UAParser();class re extends F{constructor(t,i,a,n,r,f,E,g,d,R){super(t);v(this,"GA_URL");this.analyticsStorage=i,this.analyticsService=a,this.globalStateService=n,this.fetchService=r,this.userService=f,this.appService=E,this.notificationService=g,this.i18nService=d,this.connectionService=R;const _=new URL(ae);_.searchParams.set("measurement_id",ne),_.searchParams.set("api_secret",oe),this.GA_URL=_.href,this.analyticsService.use(this)}async boot(){await this.analyticsStorage.sync(),this.analyticsStorage.state.sessionId||await this.updateSessionId(),this.bootResolve()}async send(t){if(await this.bootPromise,!this.available)return;const i=this.formatData(t);await this.fetchService.request({url:this.GA_URL,method:"POST",body:i})}formatData(t){var r;const i=this.globalStateService.udid.value,a=this.getUserProperties(),n={name:t.name,params:{session_id:this.analyticsStorage.state.sessionId,screen_name:"main",engagement_time_msec:100,runtime_last_error:((r=o.runtime.lastError)==null?void 0:r.message)??"not_set",...t.data??{}}};return{client_id:i,user_properties:a,events:[n]}}getUserProperties(){var g,d;const t=o.runtime.getManifest(),i=this.globalStateService.udid.value,a=((g=this.appService.geolocation)==null?void 0:g.country)??"n/a",n=((d=this.userService.subscription)==null?void 0:d.name)??"free",r=this.notificationService.permition==="allowed"?"on":"off",f=()=>this.appService.colorTheme==="dark"?"on":this.appService.colorTheme==="light"?"off":"default";return{user_type:{value:this.userService.userType},plan:{value:n},udid:{value:i},version:{value:t.version},platform:{value:"chrome_extension"},user_country:{value:a},desktop_notifications:{value:r},dark_mode:{value:f()},language:{value:this.i18nService.activeLocale},auto_connect:{value:this.connectionService.useAutoConnect},browser:{value:m.browser.name??"n/a"},browser_version:{value:m.browser.version??"n/a"},os:{value:m.os.name??"n/a"},os_version:{value:m.os.version??"n/a"}}}async updateSessionId(){const t=Y();await this.analyticsStorage.setItems({sessionId:t})}}const ce=new U("google-analytics",ie),c=new re("google-analytics",ce,p,l,G,x,w,h,y,P);var S=(s=>(s[s.not_active=0]="not_active",s[s.control=1]="control",s[s.test=2]="test",s))(S||{});const le=u.object({group:u.nativeEnum(S),experiment_name:u.string(),experiment_slug:u.string()}),ue=u.object({config:le.optional().describe(A.session),activeExperimentSlug:u.string().describe(A.persist)}).default({activeExperimentSlug:""}),pe=new D(ue),he="https://split-tool.com/api/application-experiment/group/",ge="e9efc93ef559ff3064712c2a3399aff66eb8",C="https://veepn.com/",k="veepn-ab-tests";class de extends j{constructor(t,i,a,n){super();v(this,"experimentSlug","abtest_chrome_adblock");this.testStorage=t,this.globalStateService=i,this.fetchService=a,this.analyticsService=n}get config(){return this.testStorage.state.config??null}get fetureAvailable(){if(!this.testStorage.state.config)return!1;const{group:t,experiment_slug:i}=this.testStorage.state.config;return i===this.experimentSlug&&t===S.test}async boot(){await this.testStorage.sync(),this.testStorage.state.activeExperimentSlug===this.experimentSlug&&!this.testStorage.state.config&&await this.fetchConfig(),this.bootResolve(),await this.bootPromise}async allowTestInitialisation(){await this.testStorage.setItems({activeExperimentSlug:this.experimentSlug})}async fetchConfig(){const t={bundle_id:ge,udid:this.globalStateService.udid.value,experiment_name:this.experimentSlug,language:"en"},i=await this.fetchService.request({url:he,method:"POST",body:t});if(i.success){await this.testStorage.setItems({config:i.data}),await this.analyticsService.setExperiment({slug:i.data.experiment_slug,group:i.data.group});const{group:a,experiment_slug:n}=i.data;a===S.not_active?await this.clearGroupFromCookie():typeof await this.getGroupFromCookie()>"u"&&(await this.saveGroupToCookie(a),this.analyticsService.sendEvent({type:"google-analytics",name:`${n}_group_${a}`,data:{test_name:n,user_group:a}}),this.analyticsService.sendEvent({type:"aws-kinesis",name:"exp_group",data:{event_properties__exp_id:n,event_properties__exp_var:a.toString()}}))}}async getGroupFromCookie(){const t=new URL(C),i=await o.cookies.get({name:k,url:t.href});if(i)try{const n=JSON.parse(i.value).find(r=>r.slug===this.experimentSlug);return n?n.group:void 0}catch{return}}async saveGroupToCookie(t){const i=new URL(C),a=new Date;a.setFullYear(a.getFullYear()+1);const n=[{slug:this.experimentSlug,group:t}];await o.cookies.set({name:k,value:JSON.stringify(n),url:i.href,domain:`.${i.hostname}`,expirationDate:a.getTime()/1e3})}async clearGroupFromCookie(){const t=new URL(C);await o.cookies.remove({name:k,url:t.href})}}const ve=new U("test",pe),O=new de(ve,l,G,p);class me{constructor(e){this.adblockTest=e}async getAdblockData(){return await Promise.resolve(),{success:!0,data:{available:this.adblockTest.fetureAvailable}}}}class Se{constructor(e,t){this.messageService=e,this.abTestsController=t}init(){this.messageService.subscribe({"get-adblock-data":this.getAdblockData.bind(this)})}async getAdblockData(){return{...await this.abTestsController.getAdblockData(),type:"get-adblock-data"}}}const be=new me(O),we=new Se(L,be);class ye{constructor(e,t,i,a,n,r){this.globalStateService=e,this.i18nService=t,this.accessService=i,this.notificationService=a,this.analyticsService=n,this.adblockTest=r}async execute(e){e.reason==="install"&&(!await this.globalStateService.getCookiesUdid()&&await this.adblockTest.allowTestInitialisation(),await this.onInstall()),e.reason==="update"&&await this.onUpdate()}async onInstall(){await this.globalStateService.appBooted;const e=this.globalStateService.udid.type==="new"?"install":"reinstall";this.analyticsService.sendEvent({type:"google-analytics",name:"launch_first_time",data:{install_type:e}}),e==="reinstall"&&this.analyticsService.sendEvent({type:"google-analytics",name:"reinstall_app_launch"}),await this.accessService.proceedToWebsitePage({page:"install",params:{utm_campaign:"welcome"}})}async onUpdate(){await this.globalStateService.appBooted,this.analyticsService.sendEvent({type:"google-analytics",name:"update_app_version"});const e=o.runtime.getManifest();await this.notificationService.notify({options:{title:this.i18nService.t("base:update-notification.title"),message:this.i18nService.t("base:update-notification.message",{tr_version:`v${e.version}`})},callback:"extension-updated"})}}class fe{constructor(e,t,i){this.globalStateService=e,this.connectionService=t,this.connectionController=i}async execute(){await this.globalStateService.appBooted,this.connectionService.useAutoConnect&&this.globalStateService.hasInternetConnection?await this.connectionController.connect():await this.connectionController.disconnect()}}const _e=new ye(l,y,b,h,p,O),Ce=new fe(l,P,T);o.runtime.onInstalled.addListener(s=>{_e.execute(s).catch(()=>{})});o.runtime.onStartup.addListener(()=>{Ce.execute().catch(()=>{})});class ke{constructor(e){this.proxyService=e}async execute(e,t){return await this.proxyService.bootPromise,this.proxyService.serverConfigList.flatMap(a=>a.addresses).includes(e.challenger.host)?this.proxyService.authCredentials?(t&&t({authCredentials:this.proxyService.authCredentials}),this.proxyService.authCredentials):(t&&t({}),{}):(t&&t({}),{})}}const Ae=new ke(N);o.webRequest.onAuthRequired.addListener((s,e)=>{Ae.execute(s,e).catch(()=>{})},{urls:["<all_urls>"]},["asyncBlocking"]);class Le{constructor(e){this.connectionController=e}async execute(e){(e.levelOfControl==="not_controllable"||e.levelOfControl==="controlled_by_other_extensions")&&await this.connectionController.disconnect()}}const xe=new Le(T);o.proxy.settings.onChange.addListener(s=>{xe.execute(s).catch(()=>{})});function Pe(){const s=B.UAParser();if(!s.os.name)return"other";const e=s.os.name.toLocaleLowerCase();return e.includes("linux")?"linux":e.includes("mac")?"macos":e.includes("windows")?"windows":"other"}class Te{constructor(e,t,i,a,n,r){v(this,"actionMap",{"download-app":this.callbackDownloadApp.bind(this),"extension-updated":this.callbackExtensionUpdated.bind(this)});this.globalStateService=e,this.notificationService=t,this.appService=i,this.userService=a,this.accessService=n,this.analyticsService=r}async execute(e){var i,a;await this.globalStateService.appBooted;const t=this.notificationService.getCallbackSettings(e);t&&t.callback&&await((a=(i=this.actionMap)[t.callback])==null?void 0:a.call(i)),await this.notificationService.removeCallbackSettings(e)}async callbackDownloadApp(){const e=Pe(),t=await this.appService.getDownloadLink(e);o.tabs.create({url:t}).catch(()=>{}),this.analyticsService.sendEvent({type:"google-analytics",name:"notify_popup_pc_download_click_free_download"})}async callbackExtensionUpdated(){this.userService.canUsePremiumDomain||await this.accessService.proceedToWebsitePage({page:"pricing",params:{utm_campaign:"update_notification"}}),this.analyticsService.sendEvent({type:"google-analytics",name:"update_popup_click"})}}const Oe=new Te(l,h,w,x,b,p);o.notifications.onClicked.addListener(s=>{Oe.execute(s).catch(()=>{})});class Ee{constructor(e,t){this.globalStateService=e,this.eventService=t}async execute(){navigator.onLine!==this.globalStateService.hasInternetConnection&&(await this.globalStateService.setHasInternetConnection(navigator.onLine),this.eventService.dispatch({"internet-connection-changed":{online:navigator.onLine}}))}}const Ie=new Ee(l,H);var I;(I=navigator.connection)==null||I.addEventListener("change",()=>{Ie.execute().catch(()=>{})});(async()=>{te.init(),J.init(),M.init(),we.init(),await l.boot(),await p.boot(),await O.boot(),await N.boot(),await b.boot(),await $.boot(),await V.boot(),await w.boot(),await P.boot(),await K.boot(),await y.boot(),await z.boot(),await h.boot(),await x.boot(),await Q.init(),await T.init(),await L.boot(),await c.boot(),l.globalboot()})().catch(s=>{var e,t;console.dir(s),typeof s=="object"&&s!==null&&"message"in s&&"stack"in s?c.available?c.send({type:"google-analytics",name:"background_boot_error",data:{error_message:String(s.message),error_stack:String(s.stack),runtime_last_error:((e=o.runtime.lastError)==null?void 0:e.message)??"not_set"}}).catch(console.dir):c.boot().then(()=>{var i;return c.send({type:"google-analytics",name:"background_boot_error",data:{error_message:String(s.message),error_stack:String(s.stack),runtime_last_error:((i=o.runtime.lastError)==null?void 0:i.message)??"not_set"}})}).catch(console.dir):c.available?c.send({type:"google-analytics",name:"background_boot_error",data:{error_message:String(s),error_stack:String(s),runtime_last_error:((t=o.runtime.lastError)==null?void 0:t.message)??"not_set"}}).catch(console.dir):c.boot().then(()=>{var i;return c.send({type:"google-analytics",name:"background_boot_error",data:{error_message:String(s),error_stack:String(s),runtime_last_error:((i=o.runtime.lastError)==null?void 0:i.message)??"not_set"}})}).catch(console.dir)});
